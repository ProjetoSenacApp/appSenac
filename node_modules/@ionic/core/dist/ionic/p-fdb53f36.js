import{b as t,c as n}from"./p-9d913add.js";import{g as o}from"./p-01cf4201.js";import{OVERLAY_BACK_BUTTON_PRIORITY as e}from"./p-761d1bee.js";let a=0;const i=new WeakMap,s=t=>({create:n=>y(t,n),dismiss:(n,o,e)=>h(document,n,o,t,e),getTop:async()=>w(document,t)}),r=s("ion-alert"),c=s("ion-action-sheet"),d=s("ion-loading"),u=s("ion-modal"),p=s("ion-picker"),l=s("ion-popover"),m=s("ion-toast"),f=t=>{"undefined"!=typeof document&&x(document);const n=a++;t.overlayIndex=n,t.hasAttribute("id")||(t.id="ion-overlay-"+n)},y=(t,n)=>"undefined"!=typeof customElements?customElements.whenDefined(t).then(()=>{const o=document.createElement(t);return o.classList.add("overlay-hidden"),Object.assign(o,n),A(document).appendChild(o),o.componentOnReady()}):Promise.resolve(),b='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',v="input:not([type=hidden]), textarea, button, select",x=t=>{0===a&&(a=1,t.addEventListener("focus",n=>((t,n)=>{const e=w(n),a=t.target;if(e&&a)if(e===a)e.lastFocus=void 0;else{const t=o(e);if(!t.contains(a))return;const i=t.querySelector(".ion-overlay-wrapper");if(!i)return;if(i.contains(a))e.lastFocus=a;else{const t=e.lastFocus;((t,n)=>{let o=t.querySelector(b);const e=o&&o.shadowRoot;e&&(o=e.querySelector(v)||o),o?o.focus():n.focus()})(i,e),t===n.activeElement&&((t,n)=>{const o=Array.from(t.querySelectorAll(b));let e=o.length>0?o[o.length-1]:null;const a=e&&e.shadowRoot;a&&(e=a.querySelector(v)||e),e?e.focus():n.focus()})(i,e),e.lastFocus=n.activeElement}}})(n,t),!0),t.addEventListener("ionBackButton",n=>{const o=w(t);o&&o.backdropDismiss&&n.detail.register(e,()=>o.dismiss(void 0,G))}),t.addEventListener("keyup",n=>{if("Escape"===n.key){const n=w(t);n&&n.backdropDismiss&&n.dismiss(void 0,G)}}))},h=(t,n,o,e,a)=>{const i=w(t,e,a);return i?i.dismiss(n,o):Promise.reject("overlay does not exist")},w=(t,n,o)=>{const e=((t,n)=>(void 0===n&&(n="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(t.querySelectorAll(n)).filter(t=>t.overlayIndex>0)))(t,n);return void 0===o?e[e.length-1]:e.find(t=>t.id===o)},g=async(o,e,a,i,s)=>{if(o.presented)return;o.presented=!0,o.willPresent.emit();const r=t(o),c=o.enterAnimation?o.enterAnimation:n.get(e,"ios"===r?a:i);await B(o,c,o.el,s)&&o.didPresent.emit(),"ION-TOAST"!==o.el.tagName&&k(o.el),o.keyboardClose&&o.el.focus()},k=async t=>{let n=document.activeElement;if(!n)return;const o=n&&n.shadowRoot;o&&(n=o.querySelector(v)||n),await t.onDidDismiss(),n.focus()},j=async(o,e,a,s,r,c,d)=>{if(!o.presented)return!1;o.presented=!1;try{o.el.style.setProperty("pointer-events","none"),o.willDismiss.emit({data:e,role:a});const u=t(o),p=o.leaveAnimation?o.leaveAnimation:n.get(s,"ios"===u?r:c);"gesture"!==a&&await B(o,p,o.el,d),o.didDismiss.emit({data:e,role:a}),i.delete(o)}catch(u){console.error(u)}return o.el.remove(),!0},A=t=>t.querySelector("ion-app")||t.body,B=async(t,o,e,a)=>{e.classList.remove("overlay-hidden");const s=o(e.shadowRoot||t.el,a);t.animated&&n.getBoolean("animated",!0)||s.duration(0),t.keyboardClose&&s.beforeAddWrite(()=>{const t=e.ownerDocument.activeElement;t&&t.matches("input, ion-input, ion-textarea")&&t.blur()});const r=i.get(t)||[];return i.set(t,[...r,s]),await s.play(),!0},E=(t,n)=>{let o;const e=new Promise(t=>o=t);return O(t,n,t=>{o(t.detail)}),e},O=(t,n,o)=>{const e=a=>{t.removeEventListener(n,e),o(a)};t.addEventListener(n,e)},P=t=>"cancel"===t||t===G,T=t=>t(),z=(t,o)=>{if("function"==typeof t)return n.get("_zoneGate",T)(()=>{try{return t(o)}catch(n){console.error(n)}})},G="backdrop";export{G as B,r as a,c as b,l as c,g as d,f as e,j as f,E as g,i as h,P as i,d as l,u as m,p,z as s,m as t}