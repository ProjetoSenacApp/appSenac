'use strict';

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _fireLog = require('fire-log');

var _fireLog2 = _interopRequireDefault(_fireLog);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactJss = require('react-jss');

var _jssNormalize = require('jss-normalize');

var _jssNormalize2 = _interopRequireDefault(_jssNormalize);

var _createBrowserHistory = require('history/createBrowserHistory');

var _createBrowserHistory2 = _interopRequireDefault(_createBrowserHistory);

var _reactRouterDom = require('react-router-dom');

var _index = require('../startup/index.js');

var _index2 = require('../style/index.js');

var _index3 = require('../store/index.js');

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var log = new _fireLog2.default('fire:client');
var history = (0, _createBrowserHistory2.default)();
_index4.default.setHistory(history);

// TODO: Or should we use JssProvider and create our own jss instance?
_reactJss.jss.createStyleSheet(_jssNormalize2.default, { named: false }).attach();

var App = function (_React$Component) {
    (0, _inherits3.default)(App, _React$Component);

    function App() {
        (0, _classCallCheck3.default)(this, App);
        return (0, _possibleConstructorReturn3.default)(this, (App.__proto__ || (0, _getPrototypeOf2.default)(App)).apply(this, arguments));
    }

    (0, _createClass3.default)(App, [{
        key: 'render',
        value: function render() {
            var components = (0, _index.getComponents)();

            if (components.length !== 1) {
                log.error('There should be one startup component.');

                throw new Error();
            }

            var Component = components[0];

            return _react2.default.createElement(
                _reactJss.ThemeProvider,
                { theme: (0, _index2.getTheme)() },
                _react2.default.createElement(
                    _reactRouterDom.Router,
                    { history: history },
                    _react2.default.createElement(Component, null)
                )
            );
        }
    }]);
    return App;
}(_react2.default.Component);

_reactDom2.default.render(_react2.default.createElement(App, null), document.getElementById('root'));

var callbacks = (0, _index.getCallbacks)();

callbacks.forEach(function (callback) {
    return callback();
});