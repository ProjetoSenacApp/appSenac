!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/fire"),require("@angular/common")):"function"==typeof define&&define.amd?define("@angular/fire/performance",["exports","@angular/core","rxjs","rxjs/operators","@angular/fire","@angular/common"],n):n(((e=e||self).angular=e.angular||{},e.angular.fire=e.angular.fire||{},e.angular.fire.performance={}),e.ng.core,e.rxjs,e.rxjs.operators,e.angular.fire,e.ng.common)}(this,(function(e,n,r,t,o,i){"use strict";var u=new n.InjectionToken("angularfire2.performance.auto_trace"),a=new n.InjectionToken("angularfire2.performance.instrumentationEnabled"),c=new n.InjectionToken("angularfire2.performance.dataCollectionEnabled"),s=function(e,n,u,a,c){return this.zone=a,this.performance=r.of(void 0).pipe(t.switchMap((function(){return i.isPlatformBrowser(c)?a.runOutsideAngular((function(){return import("firebase/performance")})):r.EMPTY})),t.map((function(){return a.runOutsideAngular((function(){return e.performance()}))})),t.tap((function(e){!1===n&&(e.instrumentationEnabled=!1),!1===u&&(e.dataCollectionEnabled=!1)})),t.shareReplay({bufferSize:1,refCount:!1})),o.ɵlazySDKProxy(this,this.performance,a)};s.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],s.ctorParameters=function(){return[{type:o.FirebaseApp},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[a]}]},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[c]}]},{type:n.NgZone},{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},s.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new s(n.ɵɵinject(o.FirebaseApp),n.ɵɵinject(a,8),n.ɵɵinject(c,8),n.ɵɵinject(n.NgZone),n.ɵɵinject(n.PLATFORM_ID))},token:s,providedIn:"any"});var f=function(e){if("undefined"!=typeof window&&window.performance){var n=window.performance.getEntriesByName(e,"measure")||[],t="_"+e+"Start["+n.length+"]",o="_"+e+"End["+n.length+"]";return new r.Observable((function(n){return window.performance.mark(t),n.next(),{unsubscribe:function(){window.performance.mark(o),window.performance.measure(e,t,o)}}}))}return r.EMPTY},p="_isStableStart",b="_isStableEnd";var l=!("undefined"==typeof window||!window.performance||(window.performance.mark(p),0)),d=function(){function e(e){l&&(this.disposable=e.isStable.pipe(t.first((function(e){return e})),t.tap((function(){window.performance.mark(b),window.performance.measure("isStable",p,b)}))).subscribe())}return e.prototype.ngOnDestroy=function(){this.disposable&&this.disposable.unsubscribe()},e}();d.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],d.ctorParameters=function(){return[{type:n.ApplicationRef}]},d.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new d(n.ɵɵinject(n.ApplicationRef))},token:d,providedIn:"any"});var m=function(e,n){e.dataCollectionEnabled};m.decorators=[{type:n.NgModule,args:[{providers:[s]}]}],m.ctorParameters=function(){return[{type:s},{type:d,decorators:[{type:n.Optional}]}]},e.AUTOMATICALLY_TRACE_CORE_NG_METRICS=u,e.AngularFirePerformance=s,e.AngularFirePerformanceModule=m,e.DATA_COLLECTION_ENABLED=c,e.INSTRUMENTATION_ENABLED=a,e.PerformanceMonitoringService=d,e.trace=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){return o.unsubscribe()}),(function(){}),(function(){return o.unsubscribe()}))).subscribe(r)}))}},e.traceUntil=function(e,n,o){return function(i){return new r.Observable((function(r){var u=f(e).subscribe();return i.pipe(t.tap((function(e){return n(e)&&u.unsubscribe()}),(function(){}),(function(){return o&&o.orComplete&&u.unsubscribe()}))).subscribe(r)}))}},e.traceUntilComplete=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){}),(function(){}),(function(){return o.unsubscribe()}))).subscribe(r)}))}},e.traceUntilFirst=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){return o.unsubscribe()}),(function(){}),(function(){}))).subscribe(r)}))}},e.traceWhile=function(e,n,o){return function(i){return new r.Observable((function(r){var u;return i.pipe(t.tap((function(r){n(r)?u=u||f(e).subscribe():(u&&u.unsubscribe(),u=void 0)}),(function(){}),(function(){return o&&o.orComplete&&u&&u.unsubscribe()}))).subscribe(r)}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-fire-performance.umd.min.js.map